plugins {
    id 'com.android.application'
    id 'kotlin-android'
    id 'kotlin-kapt'
    id 'kotlinx-serialization'
    id 'dagger.hilt.android.plugin'
    id 'com.google.gms.google-services'
    id 'com.google.firebase.crashlytics'
    id 'org.jetbrains.dokka'
}

android {
    compileSdkVersion buildConfig.compileSdk
    defaultConfig {
        applicationId "com.ericafenyo.habitdiary"
        minSdkVersion buildConfig.minSdk
        targetSdkVersion buildConfig.targetSdk
        versionCode 1
        versionName "1.0"

        testInstrumentationRunner "androidx.test.runner.AndroidJUnitRunner"
    }

    buildTypes {
        release {
            minifyEnabled false
            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'
        }
    }
    buildTypes.each {
        it.buildConfigField('String', 'MAPBOX_ACCESS_TOKEN', "\"$MAPBOX_ACCESS_TOKEN\"")
    }

    compileOptions {
        // Flag to enable support for the new language APIs
        coreLibraryDesugaringEnabled true

        // Sets Java compatibility to Java 8
        sourceCompatibility JavaVersion.VERSION_1_8
        targetCompatibility JavaVersion.VERSION_1_8
    }
    kotlinOptions {
        // Sets Kotlin compatibility to Java 8
        jvmTarget = '1.8'

        // Use experimental features
        freeCompilerArgs += [
                "-Xuse-experimental=kotlinx.coroutines.ExperimentalCoroutinesApi",
                "-Xuse-experimental=kotlinx.coroutines.ObsoleteCoroutinesApi",
                "-Xuse-experimental=kotlinx.coroutines.FlowPreview",
                "-Xopt-in=kotlin.RequiresOptIn"
        ]
    }

    buildFeatures {
        dataBinding true
    }
}

dependencies {
    implementation project(path: ':shared')
    implementation project(path: ':data')
    implementation project(path: ':tracker')
    implementation project(path: ':model')

    coreLibraryDesugaring libs.android.tools.desugarJdkLibs

    testImplementation libs.junit
    androidTestImplementation(libs.androidx.junitExt)
    androidTestImplementation(libs.androidx.espresso)

    implementation(libs.kotlin.stdlib)

    implementation libs.kotlin.serialization.json

    implementation(libs.androidx.core)
    implementation(libs.androidx.material)
    implementation(libs.androidx.constraintlayout)

    implementation(libs.androidx.navigation.fragment)
    implementation(libs.androidx.navigation.ui)

    implementation(libs.androidx.lifecycle.livedata)

    implementation(libs.androidx.preference)

    implementation libs.hilt.android
    kapt libs.hilt.compiler

    implementation libs.crashlytics.ktx

    implementation libs.mapbox.android
    implementation libs.mapbox.annotation

    implementation libs.timber
    implementation libs.databinding
    implementation libs.glide

    implementation libs.slimChart
    implementation libs.speedDial

    implementation libs.androidx.room.runtime

    implementation libs.materialratingbar

    implementation libs.threetenabp
    implementation libs.google.gms.location

    implementation libs.androidx.activity

    implementation libs.androidx.fragment

    implementation libs.flexbox

    implementation libs.androidChart

    debugImplementation libs.leakCanary
}
