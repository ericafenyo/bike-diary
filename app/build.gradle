plugins {
    id 'com.android.application'
    id 'kotlin-android'
    id 'kotlin-kapt'
    id 'dagger.hilt.android.plugin'
    id 'com.google.gms.google-services'
    id 'com.google.firebase.crashlytics'
    id 'org.jetbrains.dokka'
}

android {
    compileSdkVersion 30
    buildToolsVersion "30.0.2"

    defaultConfig {
        applicationId "com.ericafenyo.habitdiary"
        minSdkVersion 21
        targetSdkVersion 30
        versionCode 1
        versionName "1.0"

        testInstrumentationRunner "androidx.test.runner.AndroidJUnitRunner"
    }

    buildTypes {
        release {
            minifyEnabled false
            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'
        }
    }
    buildTypes.each {
        it.buildConfigField('String', 'MAPBOX_ACCESS_TOKEN', MAPBOX_ACCESS_TOKEN)
    }

    compileOptions {
        sourceCompatibility JavaVersion.VERSION_1_8
        targetCompatibility JavaVersion.VERSION_1_8
    }
    kotlinOptions {
        jvmTarget = '1.8'
        freeCompilerArgs += [
                "-Xuse-experimental=kotlinx.coroutines.ExperimentalCoroutinesApi",
                "-Xuse-experimental=kotlinx.coroutines.ObsoleteCoroutinesApi",
                "-Xuse-experimental=kotlinx.coroutines.FlowPreview",
                "-Xopt-in=kotlin.RequiresOptIn"
        ]
    }

    buildFeatures {
        dataBinding true
    }
}

dependencies {
    api(platform(project(":bom")))
    implementation project(path: ':shared')
    kapt(platform(project(":bom")))

    implementation project(path: ':data')
    implementation project(path: ':tracker')

    // Kotlin
    implementation(libs.kotlin.stdlib)

    // Tests
    testImplementation(Lib.JUNIT)
    androidTestImplementation(Lib.EXT_JUNIT)
    androidTestImplementation(Lib.ESPRESSO_CORE)

    // Android Jetpack
    implementation(Lib.CORE_KTX)
    implementation(Lib.MATERIAL)
    implementation(Lib.CONSTRAINT_LAYOUT)
    implementation(Lib.NAVIGATION_FRAGMENT_KTX)
    implementation(Lib.NAVIGATION_UI_KTX)
    implementation(Lib.LIFECYCLE_LIVE_DATA_KTX)
    implementation(Lib.HILT_ANDROID)
    //implementation(Lib.HILT_VIEWMODEL)
    kapt(Lib.HILT_COMPILER)
    //kapt(Lib.ANDROIDX_HILT_COMPILER)
    implementation(Lib.PREFERENCE)

    // Firebase
    implementation(Lib.FIREBASE_CRASHLYTICS)

    // Utils
    implementation(Lib.TIMBER)
    implementation(Lib.DATABINDING_KTX)
    implementation(Lib.GLIDE)

    // Others
    implementation(Lib.MAP_BOX)

    implementation(libs.slimChart)
    implementation "com.leinardi.android:speed-dial:3.1.0"
}
